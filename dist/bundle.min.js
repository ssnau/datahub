!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module){module.exports=require("./lib")},{"./lib":2}],2:[function(require,module){function isNully(val){return void 0===val||null===val||""===val}function Hub(name){this._nextData={},this._data={},this._listeners={},this._globalListeners=[],this._tempCallbacks=[],this._invokedKeys={},this.$name=name,isNully(name)&&(name="anomynous-hub-"+Hub._count,instanceCount++),instances[name]=this}function log(){ENABLE_LOG&&void 0!==typeof console&&console.log&&console.log.apply(console,arguments)}function tick(func){var handle=null;return function(){log("handle is:",handle&&handle._idleStart);var context=this,args=arguments;handle||(handle=setTimeout(function(){handle=null,func.apply(context,args)},1))}}var keys=require("object-keys"),each=require("util-each"),util=require("./util"),filter=(util.indexOf,util.filter),map=util.map,exclude=util.exclude,DELIMITER="__DATAHUB__DELEMITER__",INJECTOR="__$$hubInjectors",ENABLE_LOG=!0,instances={},instanceCount=0;Hub.getInstance=function(name,onlyGet){var instance=instances[name];return instance?instance:onlyGet?null:new Hub(name)},Hub.prototype={constructor:Hub,_mapValues:function(keys){var me=this;return map(keys,function(key){return me._data[key]})},_set:function(name,value){log("setting "+name+" with value "+value),this._nextData[name]=value,this._digest()},_digest:tick(function(){log("digesting");var me=this,eventNames=keys(this._listeners),listeners=this._listeners,data=this._nextData,callbacks=this._globalListeners.concat(this._tempCallbacks);this._nextData={},this._tempCallbacks=[],each(data,function(val,key){if(me._data[key]!==val){me._data[key]=val,me._invokedKeys[key]=!0;var events=filter(eventNames,function(eventName){return-1!==eventName.indexOf(DELIMITER+key+DELIMITER)});eventNames=exclude(eventNames,events),callbacks=callbacks.concat(map(events,function(eventName){return listeners[eventName]}))}}),each(callbacks,function(callback){log("calling callback");var injectors=callback[INJECTOR]||[];log("injectors:",injectors),callback.apply(null,me._mapValues(injectors))})}),set:function(name,value){if(isNully(name))return void log("[warning] setting key is",name);if("string"==typeof name&&this._set(name,value),"object"==typeof name){var obj=name,me=this;each(obj,function(val,key){me._set(key,val)})}},get:function(name){return this._data[name]},on:function(names,callback){if(("string"==typeof names||"number"==typeof names)&&(names=[names]),"function"==typeof names)return void this._globalListeners.push(names);callback[INJECTOR]=names;var me=this,setted=!1;each(names,function(name){me._invokedKeys[name]&&!setted&&(setted=!0,callback.apply(null,me._mapValues(names)))}),names=[""].concat(names).concat("");var eventName=names.join(DELIMITER);this._listeners[eventName]=callback},next:function(callback){this._tempCallbacks.push(callback)}},module.exports=Hub},{"./util":3,"object-keys":4,"util-each":6}],3:[function(require,module){function wrap(name){return function(array){return polyfills[name].apply(array,[].slice.call(arguments,1))}}var polyfills={indexOf:[].indexOf||function(elt){var len=this.length>>>0,from=Number(arguments[1])||0;for(from=0>from?Math.ceil(from):Math.floor(from),0>from&&(from+=len);len>from;from++)if(from in this&&this[from]===elt)return from;return-1},filter:[].filter||function(fun){"use strict";if(null==this)throw new TypeError;var t=Object(this),len=t.length>>>0;if("function"!=typeof fun)throw new TypeError;for(var res=[],thisp=arguments[1],i=0;len>i;i++)if(i in t){var val=t[i];fun.call(thisp,val,i,t)&&res.push(val)}return res},map:[].map||function(callback,thisArg){var T,A,k;if(null==this)throw new TypeError(" this is null or not defined");var O=Object(this),len=O.length>>>0;if("function"!=typeof callback)throw new TypeError(callback+" is not a function");for(thisArg&&(T=thisArg),A=new Array(len),k=0;len>k;){var kValue,mappedValue;k in O&&(kValue=O[k],mappedValue=callback.call(T,kValue,k,O),A[k]=mappedValue),k++}return A}},indexOf=wrap("indexOf"),filter=wrap("filter"),map=wrap("map");module.exports={indexOf:indexOf,filter:filter,map:map,exclude:function(array,subarray){return filter(array,function(item){return-1===indexOf(subarray,item)})}}},{}],4:[function(require,module){"use strict";var has=Object.prototype.hasOwnProperty,toStr=Object.prototype.toString,isArgs=require("./isArguments"),hasDontEnumBug=!{toString:null}.propertyIsEnumerable("toString"),hasProtoEnumBug=function(){}.propertyIsEnumerable("prototype"),dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],keysShim=function(object){var isObject=null!==object&&"object"==typeof object,isFunction="[object Function]"===toStr.call(object),isArguments=isArgs(object),isString=isObject&&"[object String]"===toStr.call(object),theKeys=[];if(!isObject&&!isFunction&&!isArguments)throw new TypeError("Object.keys called on a non-object");var skipProto=hasProtoEnumBug&&isFunction;if(isString&&object.length>0&&!has.call(object,0))for(var i=0;i<object.length;++i)theKeys.push(String(i));if(isArguments&&object.length>0)for(var j=0;j<object.length;++j)theKeys.push(String(j));else for(var name in object)skipProto&&"prototype"===name||!has.call(object,name)||theKeys.push(String(name));if(hasDontEnumBug)for(var ctor=object.constructor,skipConstructor=ctor&&ctor.prototype===object,k=0;k<dontEnums.length;++k)skipConstructor&&"constructor"===dontEnums[k]||!has.call(object,dontEnums[k])||theKeys.push(dontEnums[k]);return theKeys};keysShim.shim=function(){return Object.keys||(Object.keys=keysShim),Object.keys||keysShim},module.exports=keysShim},{"./isArguments":5}],5:[function(require,module){"use strict";var toStr=Object.prototype.toString;module.exports=function(value){var str=toStr.call(value),isArgs="[object Arguments]"===str;return isArgs||(isArgs="[object Array]"!==str&&null!==value&&"object"==typeof value&&"number"==typeof value.length&&value.length>=0&&"[object Function]"===toStr.call(value.callee)),isArgs}},{}],6:[function(require,module){var hasOwn=Object.prototype.hasOwnProperty;module.exports=function(obj,fn,context){if(null!=obj&&obj.length===+obj.length)for(var i=0;i<obj.length;i++)fn.call(context,obj[i],i,obj);else for(var key in obj)hasOwn.call(obj,key)&&fn.call(context,obj[key],key,obj)}},{}]},{},[1]);